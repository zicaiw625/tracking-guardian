name = "Tracking Guardian"
client_id = "${SHOPIFY_API_KEY}"
application_url = "${SHOPIFY_APP_URL}"
embedded = true

[access_scopes]
# Note: write_script_tags removed - blocked by Shopify from 2025-02-01 on checkout pages
# If you still need ScriptTag scanning, keep read_script_tags; remove it if not needed
scopes = "read_orders,read_script_tags,read_pixels,write_pixels"

[auth]
redirect_urls = [
  "${SHOPIFY_APP_URL}/auth/callback",
  "${SHOPIFY_APP_URL}/auth/shopify/callback",
  "${SHOPIFY_APP_URL}/api/auth/callback"
]

[webhooks]
api_version = "2025-07"

# P0: Business webhooks for conversion tracking
[[webhooks.subscriptions]]
topics = ["orders/paid"]
uri = "/webhooks"

# GDPR compliance webhooks (mandatory)
[[webhooks.subscriptions]]
compliance_topics = ["customers/data_request", "customers/redact", "shop/redact"]
uri = "/webhooks"

[pos]
embedded = false

[build]
automatically_update_urls_on_dev = true
dev_store_url = "${SHOPIFY_DEV_STORE_URL}"

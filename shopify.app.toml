name = "Tracking Guardian"
client_id = "${SHOPIFY_API_KEY}"
application_url = "${SHOPIFY_APP_URL}"
embedded = true

[access_scopes]
# P1-1: Minimal OAuth scopes with justification
# Each scope is required for core functionality:
#
# - read_orders: Required to reconcile pixel events with actual orders via webhooks
#   Used in: webhooks.tsx (ORDERS_PAID, ORDERS_UPDATED handlers)
#
# - read_script_tags: Required for migration scanner to detect legacy ScriptTag pixels
#   Used in: services/scanner.server.ts (fetchAllScriptTags function)
#   Note: Read-only, used for scan reports to help merchants migrate.
#         We do NOT request write_script_tags - deletion guidance is provided instead.
#
# - read_pixels: Required to check existing Web Pixel installations
#   Used in: services/migration.server.ts (getExistingWebPixels function)
#
# - write_pixels: Required to create/update Web Pixel configuration
#   Used in: services/migration.server.ts (webPixelCreate, webPixelUpdate mutations)
#
# - read_customer_events: Required for Web Pixel extension to access checkout events
#   Used by: extensions/tracking-pixel (checkout_completed event tracking)
#
scopes = "read_orders,read_script_tags,read_pixels,write_pixels,read_customer_events"

[auth]
redirect_urls = [
  "${SHOPIFY_APP_URL}/auth/callback",
  "${SHOPIFY_APP_URL}/auth/shopify/callback",
  "${SHOPIFY_APP_URL}/api/auth/callback"
]

[webhooks]
api_version = "2025-07"

[[webhooks.subscriptions]]
compliance_topics = ["customers/data_request", "customers/redact", "shop/redact"]
uri = "/webhooks"

[pos]
embedded = false

[build]
automatically_update_urls_on_dev = true
dev_store_url = "${SHOPIFY_DEV_STORE_URL}"
